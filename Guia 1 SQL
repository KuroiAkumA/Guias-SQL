--SOLUCION GUIA NUMERO 1 SQL

--EJERCICIO 1
SELECT
FIRST_NAME||' '||LAST_NAME EMPLEADO,
NVL(TO_CHAR(MANAGER_ID),'NO POSEE JEFE') JEFE
FROM EMPLOYEES;

--EJERCICIO 2
SELECT
EMPLOYEE_ID EMPLEADO,
SALARY SALARIO,
TRUNC(SALARY/1000) AS "PORCENTAJE DE MOVILIZACION"
FROM EMPLOYEES;

--EJERCICIO 3
SELECT
FIRST_NAME NOMBRE,
LAST_NAME APELLIDO,
JOB_ID TRABAJO,
SUBSTR(FIRST_NAME,-LENGTH(FIRST_NAME),3)||''||LENGTH(FIRST_NAME)||''||JOB_ID USUARIO,
TO_CHAR(HIRE_DATE,'MMYYYY')||''||SUBSTR(UPPER(LAST_NAME),-2,2) AS "CLAVE USUARIO"
FROM EMPLOYEES;

--EJERCICIO 4
SELECT
RPAD(LAST_NAME,10,' ')||''||'POSEE UN SALARIO DE  '||SALARY AS "LISTADO DE SALARIOS"
FROM EMPLOYEES;

--EJERCICIO 5
SELECT
'EL EMPLEADO '||' '||FIRST_NAME||' '||LAST_NAME
||' FUE CONTRATADO EL '||TO_CHAR(HIRE_DATE,'DAY')||' '||TO_CHAR(HIRE_DATE,'DD')
||' DE '||TO_CHAR(HIRE_DATE,'MONTH')||' DEL '||TO_CHAR(HIRE_DATE,'YYYY') AS "CONTRATO"
FROM EMPLOYEES;

--EJERCICIO 6
SELECT
'EL EMPLEADO '||LAST_NAME||' POSEE UN SALRIO MENSUAL DE '||TO_CHAR(SALARY,'$999G999')
||' PERO SU SALARIO SOÑADO ES '||TO_CHAR(SALARY*3,'$999G999') AS "SALARIO SOÑADO"
FROM EMPLOYEES;

--EJERCICIO 7
SELECT
EMPLOYEE_ID EMPLEADO,
DEPARTMENT_ID DEPARTAMENTO,
SALARY AS "SALARIO ACTUAL",
TRUNC(SALARY*0.258) REAJUSTE,
TRUNC(SALARY*1.258) AS "SALARIO REJUSTADO"
FROM EMPLOYEES
WHERE SALARY < 5000
ORDER BY DEPARTMENT_ID ASC,TRUNC(SALARY*1.258) DESC;

--EJERCICIO 8
SELECT
    FIRST_NAME||' '||LAST_NAME AS "NOMBRE EMPLEADO",
    JOB_ID AS "TRABAJO QUE DESEMPEÑA",
  CASE JOB_ID
    WHEN 'AD_PRES' THEN 'A'
    WHEN 'ST_MAN' THEN 'B'
    WHEN 'IT_PROG' THEN 'C'
    WHEN 'SA_REP' THEN 'D'
    WHEN 'ST_CLERK' THEN 'E'
  ELSE 'O' END "GRADO SEGUN SU TRABAJO"
FROM EMPLOYEES
ORDER BY LAST_NAME ASC;

--EJERCICIO 9
--A.
SELECT
  FIRST_NAME||' '||LAST_NAME "NOMBRE EMPLEADO",
  SALARY SALARIO,
  TRUNC(SALARY*(TO_NUMBER(SUBSTR(TO_CHAR(SALARY),1,1))/100)) REAJUSTE
FROM EMPLOYEES;
  
--B.
SELECT
EMPLOYEE_ID EMPLEADO,
SALARY "SALARIO SIN COMISION",
NVL(COMMISSION_PCT,'0') "PORC. COMISION",
SALARY*TO_NUMBER(NVL(COMMISSION_PCT,'0')) "VALOR COMISION",
SALARY+SALARY*TO_NUMBER(NVL(COMMISSION_PCT,'0')) "SALARIO TOTAL"
FROM EMPLOYEES;

--C.
SELECT
EMPLOYEE_ID EMPLEADO,
HIRE_DATE "FECHA_CONTRATO",
SALARY SALARIO,
TO_NUMBER(TO_CHAR(SYSDATE,'YYYY'))-TO_NUMBER(TO_CHAR(HIRE_DATE,'YYYY')) "AÑOS CONTRATADO",
TRUNC(((TO_NUMBER(TO_CHAR(SYSDATE,'YYYY'))-TO_NUMBER(TO_CHAR(HIRE_DATE,'YYYY')))/100)*SALARY) "AUMENTO" 
FROM EMPLOYEES
WHERE SALARY BETWEEN 1000 AND 5000;
